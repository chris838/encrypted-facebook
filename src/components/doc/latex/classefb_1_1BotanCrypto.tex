\hypertarget{classefb_1_1BotanCrypto}{
\section{BotanCrypto$<$ N, M $>$ Class Template Reference}
\label{classefb_1_1BotanCrypto}\index{efb::BotanCrypto@{efb::BotanCrypto}}
}


Botan cryptography class using N-\/byte AES and M-\/byte RSA.  


Inheritance diagram for BotanCrypto$<$ N, M $>$:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classefb_1_1BotanCrypto}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classefb_1_1BotanCrypto_a0c0158c6ffe67cd6db789dd6a6c6cc17}{BotanCrypto} ()
\item 
unsigned int \hyperlink{classefb_1_1BotanCrypto_aaaaf0d310c60207d6c545ed3a8b72fcd}{calculateHeaderSize} (unsigned int numOfIds) const 
\item 
void \hyperlink{classefb_1_1BotanCrypto_ace3300e249bf4305ddffeee43c13d844}{encryptMessage} (std::vector$<$ \hyperlink{structefb_1_1FacebookId}{FacebookId} $>$ \&ids, std::vector$<$ \hyperlink{namespaceefb_a0c8186d9b9b7880309c27230bbb5e69d}{byte} $>$ \&data)
\item 
void \hyperlink{classefb_1_1BotanCrypto_acb98871622014be1ac47d2126c04d4de}{decryptMessage} (std::vector$<$ \hyperlink{namespaceefb_a0c8186d9b9b7880309c27230bbb5e69d}{byte} $>$ \&data)
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classefb_1_1BotanCrypto_adb7dda4b7a25248c0a2ef2304f963799}{generateNewIv} ()
\item 
void \hyperlink{classefb_1_1BotanCrypto_a6dfd64b465fd521ebad9db4cad7ab2b7}{generateNewMessageKey} ()
\item 
void \hyperlink{classefb_1_1BotanCrypto_a157ac4e58784b83f91ff8cc8ad0e3707}{setIv} (std::string \&ivstr)
\item 
void \hyperlink{classefb_1_1BotanCrypto_a432078e20f50920790d0a36d74a6db39}{setMessageKey} (std::string \&keystr)
\item 
void \hyperlink{classefb_1_1BotanCrypto_a1eadc5a54ba4734a94ade3a8a1196161}{getIv} (std::vector$<$ \hyperlink{namespaceefb_a0c8186d9b9b7880309c27230bbb5e69d}{byte} $>$ \&data)
\item 
void \hyperlink{classefb_1_1BotanCrypto_a62b318991e2c89cf7ccadbb9b9be5899}{getCipheredMessageKey} (\hyperlink{structefb_1_1FacebookId}{FacebookId} \&id, std::vector$<$ \hyperlink{namespaceefb_a0c8186d9b9b7880309c27230bbb5e69d}{byte} $>$ \&data)
\item 
void \hyperlink{classefb_1_1BotanCrypto_a77d2e662a29f4002bd2fb5fda7ec1753}{createCryptoHeader} (std::vector$<$ \hyperlink{structefb_1_1FacebookId}{FacebookId} $>$ \&ids, std::vector$<$ \hyperlink{namespaceefb_a0c8186d9b9b7880309c27230bbb5e69d}{byte} $>$ \&data)
\begin{DoxyCompactList}\small\item\em Create the crypto header using a new IV and message key. \item\end{DoxyCompactList}\item 
void \hyperlink{classefb_1_1BotanCrypto_af19ddf3f04af1a9bdc9ade40b259d75c}{parseCryptoHeader} (std::vector$<$ \hyperlink{namespaceefb_a0c8186d9b9b7880309c27230bbb5e69d}{byte} $>$ \&data)
\begin{DoxyCompactList}\small\item\em Attempty to parse a crypto header -\/ this will retrieve and set the message key and IV. \item\end{DoxyCompactList}\item 
unsigned int \hyperlink{classefb_1_1BotanCrypto_aeea9d6426438fd56e7ef699e9189993a}{retrieveHeaderSize} (std::vector$<$ \hyperlink{namespaceefb_a0c8186d9b9b7880309c27230bbb5e69d}{byte} $>$ \&data) const 
\begin{DoxyCompactList}\small\item\em Get the header size. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
Botan::LibraryInitializer \hyperlink{classefb_1_1BotanCrypto_a8268da23ee821c4de9e701f6cfb8f97b}{init}
\begin{DoxyCompactList}\small\item\em Botan library members. \item\end{DoxyCompactList}\item 
Botan::AutoSeeded\_\-RNG \hyperlink{classefb_1_1BotanCrypto_af0dc1f5b610b421b2953da670c1df0ab}{rng}
\item 
Botan::SymmetricKey \hyperlink{classefb_1_1BotanCrypto_ad10c9baa2a09c7cbc7913d36a9f9afc1}{key}
\item 
Botan::InitializationVector \hyperlink{classefb_1_1BotanCrypto_a2bf475fe01a413ade4ab3e1cb26b8435}{iv}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\subsubsection*{template$<$int N, int M$>$ class efb::BotanCrypto$<$ N, M $>$}

Botan cryptography class using N-\/byte AES and M-\/byte RSA. This class uses the Botan cryptography library to perform encryption and decryption in place. AES and RSA are the symmetric and asymmetric (respectively) schemes employed. The template variables $<$N,M$>$ determine the key lengths. The header consists of two length bytes specifying the number of recipients, the message IV in plaintext, and a sequence of (Facebook ID, message-\/key) pairs. Each message-\/key is encrypted under the public key of the Facebook ID it is paired with. 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classefb_1_1BotanCrypto_a0c0158c6ffe67cd6db789dd6a6c6cc17}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!BotanCrypto@{BotanCrypto}}
\index{BotanCrypto@{BotanCrypto}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{BotanCrypto}]{\setlength{\rightskip}{0pt plus 5cm}{\bf BotanCrypto} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classefb_1_1BotanCrypto_a0c0158c6ffe67cd6db789dd6a6c6cc17}


\subsection{Member Function Documentation}
\hypertarget{classefb_1_1BotanCrypto_adb7dda4b7a25248c0a2ef2304f963799}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!generateNewIv@{generateNewIv}}
\index{generateNewIv@{generateNewIv}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{generateNewIv}]{\setlength{\rightskip}{0pt plus 5cm}void generateNewIv (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_adb7dda4b7a25248c0a2ef2304f963799}
\hypertarget{classefb_1_1BotanCrypto_a6dfd64b465fd521ebad9db4cad7ab2b7}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!generateNewMessageKey@{generateNewMessageKey}}
\index{generateNewMessageKey@{generateNewMessageKey}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{generateNewMessageKey}]{\setlength{\rightskip}{0pt plus 5cm}void generateNewMessageKey (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a6dfd64b465fd521ebad9db4cad7ab2b7}
\hypertarget{classefb_1_1BotanCrypto_a157ac4e58784b83f91ff8cc8ad0e3707}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!setIv@{setIv}}
\index{setIv@{setIv}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{setIv}]{\setlength{\rightskip}{0pt plus 5cm}void setIv (
\begin{DoxyParamCaption}
\item[{std::string \&}]{ ivstr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a157ac4e58784b83f91ff8cc8ad0e3707}
\hypertarget{classefb_1_1BotanCrypto_a432078e20f50920790d0a36d74a6db39}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!setMessageKey@{setMessageKey}}
\index{setMessageKey@{setMessageKey}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{setMessageKey}]{\setlength{\rightskip}{0pt plus 5cm}void setMessageKey (
\begin{DoxyParamCaption}
\item[{std::string \&}]{ keystr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a432078e20f50920790d0a36d74a6db39}
\hypertarget{classefb_1_1BotanCrypto_a1eadc5a54ba4734a94ade3a8a1196161}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!getIv@{getIv}}
\index{getIv@{getIv}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{getIv}]{\setlength{\rightskip}{0pt plus 5cm}void getIv (
\begin{DoxyParamCaption}
\item[{std::vector$<$ {\bf byte} $>$ \&}]{ data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a1eadc5a54ba4734a94ade3a8a1196161}
\hypertarget{classefb_1_1BotanCrypto_a62b318991e2c89cf7ccadbb9b9be5899}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!getCipheredMessageKey@{getCipheredMessageKey}}
\index{getCipheredMessageKey@{getCipheredMessageKey}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{getCipheredMessageKey}]{\setlength{\rightskip}{0pt plus 5cm}void getCipheredMessageKey (
\begin{DoxyParamCaption}
\item[{{\bf FacebookId} \&}]{ id, }
\item[{std::vector$<$ {\bf byte} $>$ \&}]{ data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a62b318991e2c89cf7ccadbb9b9be5899}
\hypertarget{classefb_1_1BotanCrypto_a77d2e662a29f4002bd2fb5fda7ec1753}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!createCryptoHeader@{createCryptoHeader}}
\index{createCryptoHeader@{createCryptoHeader}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{createCryptoHeader}]{\setlength{\rightskip}{0pt plus 5cm}void createCryptoHeader (
\begin{DoxyParamCaption}
\item[{std::vector$<$ {\bf FacebookId} $>$ \&}]{ ids, }
\item[{std::vector$<$ {\bf byte} $>$ \&}]{ data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a77d2e662a29f4002bd2fb5fda7ec1753}


Create the crypto header using a new IV and message key. 

\hypertarget{classefb_1_1BotanCrypto_af19ddf3f04af1a9bdc9ade40b259d75c}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!parseCryptoHeader@{parseCryptoHeader}}
\index{parseCryptoHeader@{parseCryptoHeader}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{parseCryptoHeader}]{\setlength{\rightskip}{0pt plus 5cm}void parseCryptoHeader (
\begin{DoxyParamCaption}
\item[{std::vector$<$ {\bf byte} $>$ \&}]{ data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_af19ddf3f04af1a9bdc9ade40b259d75c}


Attempty to parse a crypto header -\/ this will retrieve and set the message key and IV. 

\hypertarget{classefb_1_1BotanCrypto_aeea9d6426438fd56e7ef699e9189993a}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!retrieveHeaderSize@{retrieveHeaderSize}}
\index{retrieveHeaderSize@{retrieveHeaderSize}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{retrieveHeaderSize}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int retrieveHeaderSize (
\begin{DoxyParamCaption}
\item[{std::vector$<$ {\bf byte} $>$ \&}]{ data}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_aeea9d6426438fd56e7ef699e9189993a}


Get the header size. 

\hypertarget{classefb_1_1BotanCrypto_aaaaf0d310c60207d6c545ed3a8b72fcd}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!calculateHeaderSize@{calculateHeaderSize}}
\index{calculateHeaderSize@{calculateHeaderSize}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{calculateHeaderSize}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int calculateHeaderSize (
\begin{DoxyParamCaption}
\item[{unsigned int}]{ numOfIds}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classefb_1_1BotanCrypto_aaaaf0d310c60207d6c545ed3a8b72fcd}


Implements \hyperlink{classefb_1_1ICrypto_a1d1ef41942f8d5c114ffd8180fbe547f}{ICrypto}.

\hypertarget{classefb_1_1BotanCrypto_ace3300e249bf4305ddffeee43c13d844}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!encryptMessage@{encryptMessage}}
\index{encryptMessage@{encryptMessage}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{encryptMessage}]{\setlength{\rightskip}{0pt plus 5cm}void encryptMessage (
\begin{DoxyParamCaption}
\item[{std::vector$<$ {\bf FacebookId} $>$ \&}]{ ids, }
\item[{std::vector$<$ {\bf byte} $>$ \&}]{ data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classefb_1_1BotanCrypto_ace3300e249bf4305ddffeee43c13d844}


Implements \hyperlink{classefb_1_1ICrypto_a258cb59b2942fbac3615b14207dbdf78}{ICrypto}.

\hypertarget{classefb_1_1BotanCrypto_acb98871622014be1ac47d2126c04d4de}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!decryptMessage@{decryptMessage}}
\index{decryptMessage@{decryptMessage}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{decryptMessage}]{\setlength{\rightskip}{0pt plus 5cm}void decryptMessage (
\begin{DoxyParamCaption}
\item[{std::vector$<$ {\bf byte} $>$ \&}]{ data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classefb_1_1BotanCrypto_acb98871622014be1ac47d2126c04d4de}


Implements \hyperlink{classefb_1_1ICrypto_ac7d12b1021fd2f4bef93aac3169a35db}{ICrypto}.



\subsection{Member Data Documentation}
\hypertarget{classefb_1_1BotanCrypto_a8268da23ee821c4de9e701f6cfb8f97b}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!init@{init}}
\index{init@{init}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{init}]{\setlength{\rightskip}{0pt plus 5cm}Botan::LibraryInitializer {\bf init}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a8268da23ee821c4de9e701f6cfb8f97b}


Botan library members. 

\hypertarget{classefb_1_1BotanCrypto_af0dc1f5b610b421b2953da670c1df0ab}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!rng@{rng}}
\index{rng@{rng}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{rng}]{\setlength{\rightskip}{0pt plus 5cm}Botan::AutoSeeded\_\-RNG {\bf rng}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_af0dc1f5b610b421b2953da670c1df0ab}
\hypertarget{classefb_1_1BotanCrypto_ad10c9baa2a09c7cbc7913d36a9f9afc1}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!key@{key}}
\index{key@{key}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{key}]{\setlength{\rightskip}{0pt plus 5cm}Botan::SymmetricKey {\bf key}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_ad10c9baa2a09c7cbc7913d36a9f9afc1}
\hypertarget{classefb_1_1BotanCrypto_a2bf475fe01a413ade4ab3e1cb26b8435}{
\index{efb::BotanCrypto@{efb::BotanCrypto}!iv@{iv}}
\index{iv@{iv}!efb::BotanCrypto@{efb::BotanCrypto}}
\subsubsection[{iv}]{\setlength{\rightskip}{0pt plus 5cm}Botan::InitializationVector {\bf iv}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classefb_1_1BotanCrypto_a2bf475fe01a413ade4ab3e1cb26b8435}
